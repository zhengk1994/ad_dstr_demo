# プロジェクト説明

このプロジェクトは社内で使ってる技術に合わせて出題しました。
最後で出す納品は社内の広告配信と管理システムの簡単版です。

この中で、不明なところがあれば、各メンターに聞いてください

## システムの要求仕様

概ねに分けたら、広告主の管理画面（UI）と広告配信の機能があります。

### 広告主の管理画面（UI）

ここで、簡単の機能を作りましょう！

1. 広告管理：入稿、削除、更新する機能
2. レポート生成

基本的に、ウェブサイトのパスで認証します。もちろん、標準の方法ではないです。

> /adv/<広告主ID>/<機能パス>


#### 広告管理

このプロジェクトの広告は画像、広告文（body）と単価（price）があります。

４つのページで、広告管理機能を追加してください。

* /adv/XXX/index.html.erb - この広告主持ってる広告を全部テーブルで表示します。
                            毎行一つの広告を表示して、更新と削除ボタンがあります。
							表のした入稿ボタンがあります。
	* 更新ボタンを押すと、edit.htmlにリダイレクトします。
	* 削除ボタンを押すと、delete.htmlにリダイレクトします。
	* 入稿ボタンを押すと、new.htmlにリダイレクトします。
* /adv/XXX/new.html.erb - 新しい広告記入フォームを作ってください。
* /adv/XXX/edit.html.erb - new.htmlと同じですが、表示する時、レコードの値も表示します。
* /adv/XXX/delete.html.erb - 広告を消す。

#### レポート生成

ここのレポート作成は業務の言葉を使うので、総合研修の復習になります。

広告主毎で、持っている広告の統計を表示します。下記のコロムを含みます。

* Impression数
* Click数
* CTR
* CPM
* Total Cost

この表の上に、レポートの期間を絞る機能を追加してください。


### 広告配信

配信側UIがないですが、二つのAPIがあります。APIの要件は下記のようです。

media_site.htmは用意されたので、テストする時、このページを利用してください。
説明はmedia_site.htmのコメントを呼んでください。

#### /view

媒体のサイトからこのAPIにリクエストして、広告をとります。

DBに保存する広告をランダムで出して返します。

##### Request

```
GET /view?adspot_id=<枠ID>&count=<広告数>
```

##### Response (JSON)

```
[{
	img_url: '/adimg/<広告ID>.jpg',
	body: '<広告のテキスト>',
	ad_id: 3
}, ... ]
```

##### エラー種類

| エラーコード | 備考                                             |
| -----------  | ------                                           |
| 500          | 必要な`adspot_id`か`count`パラメーターがないから |
| 500          | Internal Server Error                            |


#### /click

すでにviewで出した広告をクリックしたら、DBにログしてあとでレポートに使われます。

ログする注意しなければならないものは、その時の単価もログしてください。（理由があるので、考えてみてください）

##### Request

```
GET /click?adspot_id=<枠ID>&ad_id=<広告ID>
```

##### Response

Body: 空
Status Code: 200/500

##### エラー

| エラーコード  | 備考                  |
| ------------- | ----------            |
| 500           | Internal Server Error |


